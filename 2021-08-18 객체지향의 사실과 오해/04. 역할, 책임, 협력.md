# 04. 역할, 책임, 협력

> *우리 모두를 합친 것보다 더 현명한 사람은 없다.   - 캔 블랜차드(Ken Blanchard)*


## 협력
- 한 사람이 다른 사람에게 도움을 요청할 때 시작됨

- 요청을 받은 사람은 일을 처리한 후, 요청한 사람에게 필요한 지식이나 서비스 제공(=요청에 *응답*)
- 협력은 다수의 연쇄적인 요청과 응답의 흐름으로 구성됨

<hr>

## 책임
- 객체지향 설계의 가장 중요한 재료

  - 크레이그 라만(Craig Larman) <br/>
    *"객체지향 개발에서 가장 중요한 능력은 책임을 능숙하게 소프트웨어 객체에 할당하는 것"*
- 책임을 어떻게 구현할 것인가 하는 문제는 객체와 책임이 제자리를 잡은 후에 고려해도 늦지 않음

<br/>

### 책임의 분류
- 책임은 객체에 의해 정의되는 응집도 있는 행위의 집합

- 즉, 객체의 책임은 '객체가 무엇을 알고 있는가(knowing)'와 '무엇을 할 수 있는가(doing)'로 구성
- **하는 것(doing)**
  - 객체를 생성하거나 계산을 하는 등의 스스로 하는 것
  
  - 다른 객체의 행동을 시작시키는 것
  - 다른 객체의 활동을 제어하고 조절하는 것
- **아는 것(knowing)**
  - 개인적인 정보에 관해 아는 것
  
  - 관련된 객체에 관해 아는 것
  - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
- 객체의 책임을 이야기할 떄는 일반적으로 외부에서 접근 가능한 공용 서비스의 관점에서 이야기함
- 즉, 책임은 객체의 외부에 제공해 줄 수 있는 정보(아는 것의 측면)와 <br>
  외부에 제공해 줄 수 있는 서비스(하는 것의 측면)의 목록
- 책임은 **객체의 공용 인터페이스(public interface)를 구성함**

<hr>

## 역할
- 재사용 가능하고 유연한 객체지향 설계를 낳는 매우 중요한 구성요소이기 때문

- 역할은 협력 내에서 다른 객체로 대체할 수 있음을 나타내는 일종의 표식
  - *"이 자리는 해당 역할을 수행할 수 있는 어떤 객체라도 대신할 수 있습니다"고 말하는 것과 같음*
  
  - 역할을 대체하기 위해서는 각 역할이 수신할 수 있는 메시지를 동일한 방식으로 이해해야 함
- 동일한 역할을 수행할 수 있다는 것 = 해당 객체들이 협력 내에서 동이한 책임의 집합을 수행할 수 있다는 것
  - 역할의 대체 가능성은 행위 호환성을 의미하고, 행위 호환성은 동일한 책임의 수행을 의미
- 객체지향 설계의 단순성(simplicity), 유연성(flexibility), 재사용성(reusability)을 뒷받침하는 핵심 개념
  - 역할의 개념 사용 시, 유사한 협력을 추상화해서 인지 과부하를 줄일 수 있음
  
  - 다양한 객체들이 협력에 참여할 수 있어 협력이 좀 더 유연해짐
  - 다양한 객체들이 동일한 협력에 참여할 수 있어 재사용성이 높아짐

<hr>

### 협력을 따라 흐르는 객체의 책임
- 올바른 객체를 설계하기 위해서는 먼저 견고하고 깔끔한 협력을 설계해야 함
  - 협력을 설계한다 = 설계에 참여하는 객체들이 주고받을 요청과 응답의 흐름을 결정한다는 것을 의미
  
- 객체에게 책임을 할당하고 나면 책임은 객체가 외부에 제공하게 될 행동이 됨
- 데이터는 행동, 즉 객체가 수행하게 될 적절한 책임을 결정한 후에 고민할 것
- 객체지향 시스템에서 가장 중요한 것은 충분히 자율적인 동시에 충분히 협력적인 객체를 창조하는 것

<hr>

## 객체지향 설계 기법
1. 책임-주도 설계(Responsibility-Driven Design)
    - 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악
    
    - 시스템 책임을 더 작은 책임으로 분할
    - 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임 할당
    - 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 됨

2. 디자인 패턴(Design pattern)
    - 패턴은 반복해서 일어나는 특정한 상황에서 어떤 설계가 왜 더 효과적인지에 대한 이유를 설명
    
    - COMPOSITE 패턴
      - 전체와 부분을 하나의 단위로 추상화해야 하는 경우에 사용할 수 있음
      
      - LEAF : 공용 인터페이스에 대한 오퍼레이션 호출에 응답할 수 있는 기본적인 행위 구현
      - Composite : 외부로부터 부분에 대한 세부 사항을 감추고 포함된 부분을 하나의 단위로 행동하는 역할
      - Client : Component에 메시지를 요청함으로써 협력하는 임의의 역할


3. 테스트-주도 개발(Test-Driven Development)
    - 책임-주도 설계의 기본 개념을 따름
    - 객체지향에 대한 깊이 있는 지식을 요구
    - 테스트를 작성하기 위해 객체의 메서드를 호출하고 반환값을 검증 = 객체가 수행해야 하는 책임에 관해 생각함
    - 테스트에 필요한 간접 입력값을 제공하기 위해 스텁(stub)을 추가하거나 <br> 간접 출력값을 검증하기 위해 목 객체(mock object)를 사용함
